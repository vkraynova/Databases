USE PC

--1. ???????? ??????, ????? ??????? ???????? ??????? ?? ???????????? ????????.
SELECT AVG(PC.SPEED) AS AvgSpeed
FROM PC;

--2. ???????? ??????, ????? ??????? ??????? ?????? ?? ???????? ?? ????????? ??
--????? ????????????.
SELECT MAKER, AVG(SCREEN) AS AvgScreen
FROM LAPTOP JOIN PRODUCT
                 ON LAPTOP.MODEL = PRODUCT.MODEL
GROUP BY MAKER;

--3. ???????? ??????, ????? ??????? ???????? ??????? ?? ????????? ? ???? ??? 1000.
SELECT AVG(SPEED) AS AvgSpeed
FROM LAPTOP
WHERE PRICE > 1000;

--4. ???????? ??????, ????? ??????? ???????? ???? ?? ???????????? ????????,
--??????????? ?? ???????????? ‘A’.
SELECT AVG(PC.PRICE)
FROM PC JOIN PRODUCT ON
        PC.MODEL = PRODUCT.MODEL
WHERE PRODUCT.MAKER = 'A';

--5. ???????? ??????, ????? ??????? ???????? ???? ?? ???????????? ???????? ?
--????????? ?? ???????????? ‘B’.
SELECT AVG(PRICE)
FROM (SELECT L.MODEL, L.PRICE
      FROM LAPTOP AS L
      UNION ALL
      SELECT P.MODEL, P.PRICE
      FROM PC AS P) AS T JOIN PRODUCT
                              ON PRODUCT.MODEL = T.MODEL
WHERE PRODUCT.MAKER = 'B'

--6. ???????? ??????, ????? ??????? ???????? ???? ?? ???????????? ????????
--?????? ?????????? ?? ???????.
SELECT PC.SPEED, AVG(PC.PRICE)
FROM PC
GROUP BY PC.SPEED

--7. ???????? ??????, ????? ??????? ???????????????, ????? ?? ????????? ???? 3
--???????? ?????????? ????????? (? ???????? ???).
SELECT PRODUCT.MAKER, COUNT(PC.CODE)
FROM PRODUCT JOIN PC
                  ON PRODUCT.MODEL = PC.MODEL
GROUP BY PRODUCT.MAKER
HAVING COUNT(PC.CODE) >= 3

--8. ???????? ??????, ????? ??????? ??????????????? ? ???-?????? ???? ??
--?????????? ????????.
SELECT PRODUCT.MAKER, PC.PRICE
FROM PRODUCT JOIN PC
                  ON PRODUCT.MODEL = PC.MODEL
WHERE PC.PRICE = (SELECT MAX(PC.PRICE) FROM PC)


--9. ???????? ??????, ????? ??????? ???????? ???? ?? ???????????? ???????? ??
--????? ??????? ??-?????? ?? 800.
SELECT AVG(PC.SPEED), AVG(PC.PRICE)
FROM PC
WHERE PC.SPEED > 800

--10.???????? ??????, ????? ??????? ??????? ?????? ?? ????? ?? ???? ??????????
--????????, ??????????? ?? ?????????????, ????? ??????????? ? ????????.
--?????????? ?? ?? ?????? ?? ????? ??????? ????????????.
SELECT PRODUCT.MAKER, AVG(PC.HD)
FROM PC JOIN PRODUCT ON PC.MODEL = PRODUCT.MODEL
WHERE MAKER IN (SELECT DISTINCT MAKER
                FROM PRODUCT JOIN PC
                                  ON PRODUCT.MODEL = PC.MODEL

                INTERSECT

                SELECT DISTINCT MAKER
                FROM PRODUCT JOIN PRINTER
                                  ON PRODUCT.MODEL = PRINTER.MODEL)
GROUP BY PRODUCT.MAKER